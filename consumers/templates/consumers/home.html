{% extends "consumers/base.html" %}
{% load humanize %}

{% block title %}Dashboard - Balilihan Waterworks{% endblock %}

{% block extra_css %}
<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

    * {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    body {
        background-color: #f8f9fa;
    }

    .main-content {
        background-color: #f8f9fa !important;
        padding: 3rem 2rem !important;
    }

    .dark-mode .main-content {
        background-color: #1a1a1a !important;
    }

    /* Dashboard Container */
    .dashboard-container {
        max-width: 900px;
        margin: 0 auto;
    }

    /* Large Centered Header */
    .main-title {
        text-align: center;
        margin-bottom: 3rem;
    }

    .main-title h1 {
        font-size: 3.5rem;
        font-weight: 800;
        color: #2d3748;
        margin: 0;
        line-height: 1.2;
    }

    .main-title h2 {
        font-size: 3rem;
        font-weight: 400;
        color: #718096;
        margin: 0;
        line-height: 1.2;
    }

    .dark-mode .main-title h1 {
        color: #ffffff;
    }

    .dark-mode .main-title h2 {
        color: #a0aec0;
    }

    /* Section Labels */
    .section-label {
        font-size: 1.5rem;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 1.5rem;
        margin-top: 2.5rem;
    }

    .dark-mode .section-label {
        color: #ffffff;
    }

    /* Statistics List */
    .stats-list {
        list-style: none;
        padding: 0;
        margin: 0 0 2rem 0;
    }

    .stat-item {
        display: flex;
        align-items: center;
        padding: 1.25rem 1.5rem;
        margin-bottom: 1rem;
        background: white;
        border-radius: 12px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }

    .stat-item:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transform: translateX(5px);
    }

    .dark-mode .stat-item {
        background: #2d2d2d;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    .dark-mode .stat-item:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1.5rem;
        font-size: 1.5rem;
    }

    .stat-icon.success {
        background-color: #10b981;
        color: white;
    }

    .stat-icon.danger {
        background-color: #ef4444;
        color: white;
    }

    .stat-icon.warning {
        background-color: #ef4444;
        color: white;
    }

    .stat-content {
        flex: 1;
    }

    .stat-label {
        font-size: 1rem;
        color: #718096;
        margin-bottom: 0.25rem;
    }

    .dark-mode .stat-label {
        color: #a0aec0;
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: #2d3748;
    }

    .dark-mode .stat-value {
        color: #ffffff;
    }

    /* Generate Button */
    .generate-btn {
        background-color: #F39C12;
        color: white;
        border: none;
        padding: 1rem 2rem;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        width: 100%;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(243, 156, 18, 0.3);
        margin-bottom: 2rem;
    }

    .generate-btn:hover {
        background-color: #E67E22;
        box-shadow: 0 6px 16px rgba(243, 156, 18, 0.4);
        transform: translateY(-2px);
    }

    .generate-btn:active {
        transform: translateY(0);
    }

    /* Collections Display */
    .collections-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .collection-item {
        display: flex;
        align-items: center;
        padding: 1rem 1.5rem;
        margin-bottom: 0.75rem;
        background: white;
        border-radius: 10px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }

    .collection-item:hover {
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        transform: translateX(3px);
    }

    .dark-mode .collection-item {
        background: #2d2d2d;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    .dark-mode .collection-item:hover {
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.5);
    }

    .collection-icon {
        font-size: 1.5rem;
        margin-right: 1rem;
    }

    .collection-text {
        font-size: 1.1rem;
        color: #2d3748;
        font-weight: 600;
    }

    .dark-mode .collection-text {
        color: #ffffff;
    }

    .collection-amount {
        margin-left: auto;
        font-size: 1.2rem;
        font-weight: 700;
        color: #10b981;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .main-title h1 {
            font-size: 2.5rem;
        }

        .main-title h2 {
            font-size: 2rem;
        }

        .section-label {
            font-size: 1.25rem;
        }

        .stat-value {
            font-size: 1.5rem;
        }

        .generate-btn {
            font-size: 1rem;
            padding: 0.875rem 1.5rem;
        }

        .main-content {
            padding: 2rem 1rem !important;
        }
    }
</style>
{% endblock %}

{% block main_content %}
<div class="dashboard-container">
    <!-- Large Centered Title -->
    <div class="main-title">
        <h1>BALILIHAN</h1>
        <h2>WATERWORKS</h2>
    </div>

    <!-- Consumers Section -->
    <h3 class="section-label">Consumers</h3>
    <ul class="stats-list">
        <li class="stat-item">
            <div class="stat-icon success">
                <i class="bi bi-check-circle-fill"></i>
            </div>
            <div class="stat-content">
                <div class="stat-label">Connected</div>
                <div class="stat-value">{{ connected_count|default:"402" }}</div>
            </div>
        </li>
        <li class="stat-item">
            <div class="stat-icon danger">
                <i class="bi bi-x-circle-fill"></i>
            </div>
            <div class="stat-content">
                <div class="stat-label">Disconnected</div>
                <div class="stat-value">{{ disconnected_count|default:"53" }}</div>
            </div>
        </li>
        <li class="stat-item">
            <div class="stat-icon warning">
                <i class="bi bi-exclamation-triangle-fill"></i>
            </div>
            <div class="stat-content">
                <div class="stat-label">Delinquent</div>
                <div class="stat-value">{{ delinquent_count|default:"3" }}</div>
            </div>
        </li>
    </ul>

    <!-- Consumer Delinquent Section -->
    <h3 class="section-label">Consumer Delinquent</h3>
    <button class="generate-btn" onclick="window.location.href='{% url 'consumers:delinquent_consumers' %}'">
        <i class="bi bi-file-earmark-text-fill me-2"></i>
        GENERATE DELINQUENT LOGS 2023
    </button>

    <!-- Collections Section -->
    <h3 class="section-label">Collections</h3>
    <ul class="collections-list">
        <li class="collection-item">
            <span class="collection-icon">ðŸ“…</span>
            <span class="collection-text">Jan 2023</span>
            <span class="collection-amount">â‚±364.5</span>
        </li>
        <li class="collection-item">
            <span class="collection-icon">ðŸ“…</span>
            <span class="collection-text">Feb 2023</span>
            <span class="collection-amount">â‚±412.3</span>
        </li>
        <li class="collection-item">
            <span class="collection-icon">ðŸ“…</span>
            <span class="collection-text">Mar 2023</span>
            <span class="collection-amount">â‚±389.7</span>
        </li>
        <li class="collection-item">
            <span class="collection-icon">ðŸ“…</span>
            <span class="collection-text">Apr 2023</span>
            <span class="collection-amount">â‚±401.2</span>
        </li>
        <li class="collection-item">
            <span class="collection-icon">ðŸ“…</span>
            <span class="collection-text">May 2023</span>
            <span class="collection-amount">â‚±378.9</span>
        </li>
        <li class="collection-item">
            <span class="collection-icon">ðŸ“…</span>
            <span class="collection-text">Jun 2023</span>
            <span class="collection-amount">â‚±425.6</span>
        </li>
    </ul>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Success notification
    setTimeout(() => {
        showToast('success', 'âœ¨ Dashboard loaded successfully!', 2000);
    }, 500);

    // Animated counter effect for statistics
    function animateValue(element, start, end, duration) {
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            element.textContent = Math.floor(progress * (end - start) + start);
            if (progress < 1) {
                window.requestAnimationFrame(step);
            }
        };
        window.requestAnimationFrame(step);
    }

    // Animate stat values on load
    document.querySelectorAll('.stat-value').forEach(el => {
        const finalValue = parseInt(el.textContent);
        el.textContent = '0';
        setTimeout(() => {
            animateValue(el, 0, finalValue, 1200);
        }, 200);
    });
});
</script>
{% endblock %}
