<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Official Receipt</title>
    {% load static %}
    <style>
        body { 
            font-family: 'Arial', sans-serif; 
            max-width: 600px; 
            margin: 0 auto; 
            padding: 20px; 
            background: white;
        }
        .receipt { 
            border: 1px solid #000; 
            padding: 20px; 
            position: relative;
        }
        .logo-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .logo {
            width: 80px;
            height: auto;
        }
        .header { 
            text-align: center; 
            margin-bottom: 15px; 
        }
        .header h2 { 
            margin: 5px 0; 
            color: #003366;
            font-size: 22px;
        }
        .header h3 {
            margin: 3px 0;
            color: #0055aa;
            font-size: 18px;
        }
        .info { 
            margin-bottom: 10px; 
        }
        .amounts { 
            margin: 20px 0; 
            font-size: 1.1em; 
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .footer { 
            text-align: center; 
            margin-top: 25px; 
            font-size: 14px;
        }
        .or-number {
            font-size: 18px;
            font-weight: bold;
            color: #d32f2f;
            margin: 10px 0;
        }
        .breakdown {
            margin: 15px 0;
            padding: 10px;
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .receipt { border: none; }
        }
    </style>
</head>
<body>
    <div class="receipt">
        <!-- Logos -->
        <div class="logo-container">
            <img src="{% static 'consumers/images/municipal.jpg' %}" alt="Municipal Logo" class="logo">
            <img src="{% static 'consumers/images/logo.jpg' %}" alt="Waterworks Logo" class="logo">
        </div>

        <!-- Header -->
        <div class="header">
            <h2>REPUBLIC OF THE PHILIPPINES</h2>
            <h3>PROVINCE OF BOHOL</h3>
            <h3>MUNICIPALITY OF BALIHAN</h3>
            <h2>BALIHAN WATERWORKS</h2>
            <p>Official Receipt</p>
        </div>

        <!-- OR Number -->
        <div class="or-number">
            OR No.: {{ payment.or_number }}
        </div>

        <!-- Payment Details -->
        <div class="info">
            <p><strong>Date:</strong> {{ payment.payment_date|date:"F d, Y g:i A" }}</p>
        </div>

        <div class="info">
            <p><strong>Received from:</strong> {{ payment.bill.consumer.first_name }} {{ payment.bill.consumer.last_name }}</p>
            <p><strong>Account Number:</strong> {{ payment.bill.consumer.account_number }}</p>
            <p><strong>Barangay:</strong> {{ payment.bill.consumer.barangay.name|default:"‚Äî" }}</p>
            <p><strong>Description:</strong> Water Bill for {{ payment.bill.billing_period|date:"F Y" }}</p>
        </div>

        <!-- Consumption & Rate Breakdown -->
        <div class="breakdown">
            <h5>Bill Computation</h5>
            <p><strong>Previous Reading:</strong> {{ payment.bill.previous_reading.reading_value }} m¬≥</p>
            <p><strong>Current Reading:</strong> {{ payment.bill.current_reading.reading_value }} m¬≥</p>
            <p><strong>Consumption:</strong> {{ payment.bill.consumption }} m¬≥</p>
            <p><strong>Rate per Cubic Meter:</strong> ‚Ç±{{ payment.bill.rate_per_cubic }}</p>
            <p><strong>Fixed Charge:</strong> ‚Ç±{{ payment.bill.fixed_charge }}</p>
            <p><strong>Total Amount:</strong> ‚Ç±{{ payment.bill.total_amount }}</p>
        </div>

        <!-- Amounts -->
        <div class="amounts">
            <p><strong>Amount Paid:</strong> ‚Ç±{{ payment.amount_paid }}</p>
            <p><strong>Cash Received:</strong> ‚Ç±{{ payment.received_amount }}</p>
            <p><strong>Change:</strong> ‚Ç±{{ payment.change }}</p>
        </div>

        <!-- Signatures -->
        <div style="margin-top: 40px; display: flex; justify-content: space-between;">
            <div style="text-align: center;">
                <p>_________________________</p>
                <p>Received by:</p>
            </div>
            <div style="text-align: center;">
                <p>_________________________</p>
                <p>Authorized Signatory</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer no-print">
            <button onclick="window.print()" class="btn btn-primary">
                üñ®Ô∏è Print Official Receipt
            </button>
            <a href="{% url 'consumers:inquire' %}" class="btn btn-secondary ms-2">
                üÜï New Payment
            </a>
        </div>
    </div>
</body>
</html>