<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Official Receipt - OR #{{ payment.or_number }}</title>
    {% load static %}

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: { 50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd', 400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 800: '#1e40af', 900: '#1e3a8a' },
                        success: { 50: '#f0fdf4', 100: '#dcfce7', 200: '#bbf7d0', 300: '#86efac', 400: '#4ade80', 500: '#22c55e', 600: '#16a34a', 700: '#15803d', 800: '#166534', 900: '#14532d' },
                        danger: { 50: '#fef2f2', 100: '#fee2e2', 200: '#fecaca', 300: '#fca5a5', 400: '#f87171', 500: '#ef4444', 600: '#dc2626', 700: '#b91c1c', 800: '#991b1b', 900: '#7f1d1d' },
                        dark: { 50: '#f9fafb', 100: '#f3f4f6', 200: '#e5e7eb', 300: '#d1d5db', 400: '#9ca3af', 500: '#6b7280', 600: '#4b5563', 700: '#374151', 800: '#1f2937', 900: '#111827' },
                        light: { 50: '#fafafa', 100: '#f5f5f5', 200: '#e5e5e5', 300: '#d4d4d4', 400: '#a3a3a3', 500: '#737373', 600: '#525252', 700: '#404040', 800: '#262626', 900: '#171717' }
                    }
                }
            }
        }
    </script>
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <style>
        @media print {
            body { margin: 0; padding: 0; }
            .no-print { display: none !important; }
            .receipt-container { box-shadow: none; border: 2px solid #000; }
            .print-border { border: 1px solid #ccc; }
        }
        @page {
            size: auto;
            margin: 10mm;
        }
    </style>
</head>
<body class="bg-light-100 p-4 md:p-8">
    <div class="max-w-2xl mx-auto">
        <!-- Receipt Container -->
        <div class="receipt-container bg-white border-2 border-dark-900 shadow-2xl p-6 md:p-8">
            <!-- Header: Logo + Text in one row -->
            <div class="flex items-center justify-between mb-6 pb-4 border-b-2 border-primary-600">
                <!-- Left Logo -->
                <img src="{% static 'consumers/images/municipal.jpg' %}" alt="Municipal Logo" class="w-16 h-16 md:w-20 md:h-20 object-contain flex-shrink-0">

                <!-- Center Text -->
                <div class="text-center flex-1 px-2">
                    <p class="text-xs md:text-sm font-bold text-primary-900 leading-tight">REPUBLIC OF THE PHILIPPINES</p>
                    <p class="text-xs md:text-sm font-semibold text-primary-800 leading-tight">PROVINCE OF BOHOL</p>
                    <p class="text-xs md:text-sm font-semibold text-primary-800 leading-tight">MUNICIPALITY OF BALILIHAN</p>
                    <p class="text-sm md:text-base font-bold text-primary-900 mt-1 leading-tight">BALILIHAN WATERWORKS</p>
                    <p class="text-xs md:text-sm font-bold text-primary-900 mt-1 px-2 py-0.5 bg-primary-100 border border-primary-300 rounded-full inline-block">OFFICIAL RECEIPT</p>
                </div>

                <!-- Right Logo -->
                <img src="{% static 'consumers/images/water_icon.png' %}" alt="Waterworks Logo" class="w-16 h-16 md:w-20 md:h-20 rounded-full border-4 border-primary-500 object-cover flex-shrink-0">
            </div>

            <!-- OR Number - Prominent Display -->
            <div class="bg-danger-50 border-l-4 border-danger-600 p-4 mb-6">
                <div class="flex items-center gap-3">
                    <i class="bi bi-receipt text-3xl text-danger-600"></i>
                    <div>
                        <p class="text-xs text-dark-600 font-medium">OR Number</p>
                        <p class="text-2xl font-bold text-danger-700">{{ payment.or_number }}</p>
                    </div>
                </div>
            </div>

            <!-- Payment Date -->
            <div class="mb-6 p-4 bg-light-50 rounded-lg border border-light-300">
                <div class="flex items-center gap-2 text-sm">
                    <i class="bi bi-calendar-check text-primary-600"></i>
                    <span class="font-medium text-dark-700">Payment Date:</span>
                    <span class="font-semibold text-dark-900">{{ payment.payment_date|date:"F d, Y g:i A" }}</span>
                </div>
            </div>

            <!-- Consumer Information -->
            <div class="mb-6 p-5 bg-primary-50 border border-primary-200 rounded-lg">
                <h4 class="text-sm font-bold text-primary-900 mb-3 flex items-center gap-2">
                    <i class="bi bi-person-circle"></i>
                    RECEIVED FROM
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                    <div>
                        <span class="text-dark-600">Name:</span>
                        <span class="font-semibold text-dark-900 ml-2">{{ payment.bill.consumer.first_name }} {{ payment.bill.consumer.last_name }}</span>
                    </div>
                    <div>
                        <span class="text-dark-600">ID Number:</span>
                        <span class="font-semibold text-dark-900 ml-2">{{ payment.bill.consumer.account_number }}</span>
                    </div>
                    <div>
                        <span class="text-dark-600">Barangay:</span>
                        <span class="font-semibold text-dark-900 ml-2">{{ payment.bill.consumer.barangay.name|default:"—" }}</span>
                    </div>
                    <div>
                        <span class="text-dark-600">Description:</span>
                        <span class="font-semibold text-dark-900 ml-2">Water Bill - {{ payment.bill.billing_period|date:"F Y" }}</span>
                    </div>
                </div>
            </div>

            <!-- Bill Computation Breakdown -->
            <div class="mb-6 border border-light-300 rounded-lg overflow-hidden">
                <div class="bg-success-600 px-4 py-2">
                    <h5 class="text-sm font-bold text-white flex items-center gap-2">
                        <i class="bi bi-calculator"></i>
                        BILL COMPUTATION
                    </h5>
                </div>
                <div class="p-4 bg-white">
                    <div class="grid grid-cols-2 gap-x-6 gap-y-2 text-sm">
                        <div class="flex justify-between py-2 border-b border-light-200">
                            <span class="text-dark-600">Previous Reading:</span>
                            <span class="font-semibold text-dark-900">{{ payment.bill.previous_reading.reading_value }} m³</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-light-200">
                            <span class="text-dark-600">Current Reading:</span>
                            <span class="font-semibold text-dark-900">{{ payment.bill.current_reading.reading_value }} m³</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-light-200">
                            <span class="text-dark-600">Consumption:</span>
                            <span class="font-bold text-primary-700">{{ payment.bill.consumption }} m³</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-light-200">
                            <span class="text-dark-600">Rate per m³:</span>
                            <span class="font-semibold text-dark-900">₱{{ payment.bill.rate_per_cubic }}</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-light-200">
                            <span class="text-dark-600">Fixed Charge:</span>
                            <span class="font-semibold text-dark-900">₱{{ payment.bill.fixed_charge }}</span>
                        </div>
                        <div class="flex justify-between py-2 bg-primary-50 px-2 rounded">
                            <span class="text-dark-700 font-bold">Total Bill:</span>
                            <span class="font-bold text-primary-700">₱{{ payment.bill.total_amount }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment Summary -->
            <div class="mb-8 p-5 bg-success-50 border-2 border-success-500 rounded-lg">
                <h5 class="text-sm font-bold text-success-900 mb-4 flex items-center gap-2">
                    <i class="bi bi-cash-stack"></i>
                    PAYMENT SUMMARY
                </h5>
                <div class="space-y-3">
                    <div class="flex justify-between items-center pb-3 border-b border-success-200">
                        <span class="text-dark-700 font-medium">Amount Paid:</span>
                        <span class="text-2xl font-bold text-success-700">₱{{ payment.amount_paid }}</span>
                    </div>
                    <div class="flex justify-between items-center text-sm">
                        <span class="text-dark-600">Cash Received:</span>
                        <span class="font-semibold text-dark-900">₱{{ payment.received_amount }}</span>
                    </div>
                    <div class="flex justify-between items-center text-sm">
                        <span class="text-dark-600">Change:</span>
                        <span class="font-semibold text-dark-900">₱{{ payment.change }}</span>
                    </div>
                </div>
            </div>

            <!-- Signatures -->
            <div class="grid grid-cols-2 gap-8 mb-6 pt-6 border-t-2 border-light-300 print-border">
                <div class="text-center">
                    <div class="mb-2 pt-8 border-b-2 border-dark-900"></div>
                    <p class="text-xs font-semibold text-dark-700 uppercase">Received By</p>
                    <p class="text-xs text-dark-500 mt-1">{{ request.user.get_full_name|default:request.user.username }}</p>
                </div>
                <div class="text-center">
                    <div class="mb-2 pt-8 border-b-2 border-dark-900"></div>
                    <p class="text-xs font-semibold text-dark-700 uppercase">Authorized Signatory</p>
                    <p class="text-xs text-dark-500 mt-1">Municipal Treasurer</p>
                </div>
            </div>

            <!-- Footer Note -->
            <div class="text-center text-xs text-dark-500 italic border-t border-light-300 pt-3">
                <p>This is an official receipt issued by Balilihan Waterworks</p>
                <p class="mt-1">Please keep this receipt for your records</p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="no-print mt-6 flex gap-3 justify-center">
            <button onclick="window.print()"
                    class="px-6 py-3 bg-primary-600 text-white rounded-lg font-semibold hover:bg-primary-700 transition-colors shadow-lg flex items-center gap-2">
                <i class="bi bi-printer-fill text-lg"></i>
                Print Receipt
            </button>
            <a href="{% url 'consumers:inquire' %}"
               class="px-6 py-3 bg-success-600 text-white rounded-lg font-semibold hover:bg-success-700 transition-colors shadow-lg flex items-center gap-2">
                <i class="bi bi-plus-circle-fill text-lg"></i>
                New Payment
            </a>
        </div>
    </div>

    <script>
        // Auto-focus on print button when page loads
        window.addEventListener('load', function() {
            // Optional: Auto-print on load (uncomment if needed)
            // window.print();
        });
    </script>
</body>
</html>
